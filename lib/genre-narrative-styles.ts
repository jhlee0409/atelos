/**
 * 장르별 서사 스타일 시스템
 * 각 장르에 맞는 톤, 대사 스타일, 딜레마 유형 등을 정의합니다.
 */

export interface GenreNarrativeStyle {
  // 서사 톤
  narrativeTone: string;
  // 대사 스타일
  dialogueStyle: string;
  // 페이싱/긴장감
  pacingNote: string;
  // 주요 테마
  thematicFocus: string;
  // 딜레마 유형
  dilemmaTypes: string[];
  // 감정 표현 범위
  emotionalRange: string;
  // 글쓰기 기법
  writingTechniques: string;
  // 분위기 키워드
  atmosphereKeywords: string[];
  // 권장 선택지 프레이밍
  choiceFraming: string;
}

export const GENRE_NARRATIVE_STYLES: Record<string, GenreNarrativeStyle> = {
  // ============================================
  // 어두운/긴장감 장르
  // ============================================
  스릴러: {
    narrativeTone: `
서사 톤: 긴장감이 팽팽하게 유지되는 서스펜스
- 모든 장면에서 "무언가 잘못될 수 있다"는 불안감 조성
- 짧고 날카로운 문장으로 긴박감 전달
- 갑작스러운 반전과 충격적 전개 허용
- 독자의 심박수를 높이는 묘사`,
    dialogueStyle: `
대사 스타일: 간결하고 의미심장한 대화
- 숨겨진 의도가 느껴지는 이중적 대사
- "..." 침묵과 말줄임표를 효과적으로 활용
- 긴장 속 유머는 자제, 진지한 톤 유지
- 캐릭터 간 심리전이 느껴지는 대화`,
    pacingNote: '빠른 전개와 숨 막히는 순간의 교차. 독자가 쉴 틈 없이 긴장 유지.',
    thematicFocus: '신뢰와 배신, 생존 본능, 숨겨진 진실, 도덕적 딜레마',
    dilemmaTypes: [
      '누군가를 믿을 것인가 의심할 것인가',
      '진실을 밝힐 것인가 숨길 것인가',
      '안전을 택할 것인가 위험을 감수할 것인가',
      '개인을 보호할 것인가 전체를 위해 희생시킬 것인가',
    ],
    emotionalRange: '불안, 의심, 공포, 긴장, 충격, 안도, 배신감',
    writingTechniques: `
- 복선과 반전을 적절히 배치
- 시간 압박감을 자주 언급
- 감각적 묘사로 긴장감 고조 (심장 소리, 땀, 호흡)
- 챕터/장면 마지막을 클리프행어로`,
    atmosphereKeywords: ['어둠', '그림자', '비', '밤', '침묵', '긴장'],
    choiceFraming: '선택의 결과가 즉각적이고 위험한 상황. "이 선택이 모든 것을 바꿀 수 있다"는 무게감.',
  },

  호러: {
    narrativeTone: `
서사 톤: 공포와 불안이 스며드는 분위기
- 천천히 조여오는 공포감 연출
- 보이지 않는 위협에 대한 두려움 강조
- 일상적인 것이 비틀어지는 섬뜩함
- 심리적 공포와 신체적 공포의 조화`,
    dialogueStyle: `
대사 스타일: 떨림과 공포가 묻어나는 대화
- 말끝이 흐려지거나 끊기는 대사
- 비명, 속삭임, 떨리는 목소리 묘사
- 침묵 속 작은 소리의 강조
- 공포에 질린 캐릭터의 비합리적 대사`,
    pacingNote: '느린 빌드업 후 급격한 공포의 폭발. 안심시킨 후 공격하는 패턴.',
    thematicFocus: '미지에 대한 공포, 인간 본성의 어둠, 생존, 광기, 초자연적 존재',
    dilemmaTypes: [
      '도망칠 것인가 맞설 것인가',
      '동료를 구할 것인가 자신만 살 것인가',
      '진실을 직면할 것인가 외면할 것인가',
      '인간성을 지킬 것인가 생존을 택할 것인가',
    ],
    emotionalRange: '공포, 두려움, 절망, 광기, 파라노이아, 섬뜩함, 극도의 긴장',
    writingTechniques: `
- 오감을 활용한 공포 묘사 (소리, 냄새, 촉감)
- 암시와 상상에 맡기는 공포
- 익숙한 것의 기이한 변형
- 점프스케어보다 심리적 압박`,
    atmosphereKeywords: ['어둠', '안개', '썩은', '차가운', '침묵', '속삭임', '그림자'],
    choiceFraming: '생존이 걸린 절박한 선택. 어떤 선택도 완전히 안전하지 않음.',
  },

  미스터리: {
    narrativeTone: `
서사 톤: 수수께끼가 겹겹이 쌓이는 구조
- 단서와 미끼를 번갈아 배치
- 독자가 추리할 수 있는 여지 제공
- 의문이 해결되면 새로운 의문 등장
- 진실에 한 걸음씩 다가가는 느낌`,
    dialogueStyle: `
대사 스타일: 정보를 숨기고 드러내는 대화
- 모호하게 말하거나 핵심을 피하는 캐릭터
- 날카로운 질문과 회피하는 답변
- 의미심장한 침묵과 눈빛 교환
- 독백을 통한 추리 과정 전달`,
    pacingNote: '단서 발견 → 추리 → 새로운 의문의 반복. 퍼즐 조각이 맞춰지는 쾌감.',
    thematicFocus: '진실 추구, 숨겨진 과거, 정의와 복수, 인간 심리',
    dilemmaTypes: [
      '진실을 파헤칠 것인가 덮어둘 것인가',
      '누구의 증언을 믿을 것인가',
      '증거를 공개할 것인가 보류할 것인가',
      '정의를 택할 것인가 관계를 지킬 것인가',
    ],
    emotionalRange: '호기심, 의심, 충격, 깨달음, 좌절, 승리감',
    writingTechniques: `
- 레드 헤링(미끼)과 진짜 단서 혼합
- 플래시백을 통한 과거 공개
- 여러 관점에서 같은 사건 묘사
- 결정적 순간의 "유레카" 연출`,
    atmosphereKeywords: ['그림자', '비밀', '문서', '사진', '과거', '흔적'],
    choiceFraming: '조사 방향과 접근법 선택. 각 선택이 다른 진실을 드러냄.',
  },

  범죄: {
    narrativeTone: `
서사 톤: 어둡고 현실적인 범죄 세계
- 도덕적 회색 지대의 인물들
- 범죄의 원인과 결과에 대한 탐구
- 사회 시스템의 부조리 노출
- 긴장감 있는 추격과 대치`,
    dialogueStyle: `
대사 스타일: 거칠고 직설적인 대화
- 은어와 전문 용어 적절히 활용
- 협박, 거래, 협상의 긴장감
- 신뢰와 배신이 교차하는 대화
- 법과 정의에 대한 냉소적 언급`,
    pacingNote: '계획과 실행, 추격과 은신의 긴박한 교차. 한 순간의 실수가 치명적.',
    thematicFocus: '정의와 복수, 충성과 배신, 권력과 부패, 인간의 탐욕',
    dilemmaTypes: [
      '법을 따를 것인가 자신만의 정의를 실현할 것인가',
      '동료를 배신할 것인가 함께 몰락할 것인가',
      '돈을 택할 것인가 양심을 택할 것인가',
      '복수할 것인가 용서할 것인가',
    ],
    emotionalRange: '분노, 복수심, 냉소, 충성, 배신감, 죄책감',
    writingTechniques: `
- 범죄 계획과 실행의 디테일
- 이중생활의 긴장감
- 플래시백으로 동기 설명
- 최후의 대결 전 심리전`,
    atmosphereKeywords: ['밤거리', '네온', '뒷골목', '현금', '총', '밀거래'],
    choiceFraming: '위험과 보상 사이의 계산. 동맹과 적이 수시로 바뀜.',
  },

  // ============================================
  // 액션/모험 장르
  // ============================================
  액션: {
    narrativeTone: `
서사 톤: 역동적이고 에너지 넘치는 전개
- 빠른 속도감과 시각적 임팩트
- 영웅적 순간과 극적인 위기
- 폭발적인 클라이맥스
- 승리의 카타르시스`,
    dialogueStyle: `
대사 스타일: 짧고 강렬한 대사
- 전투 중 외치는 함성이나 구호
- 위트 있는 원라이너
- 동료 간 신뢰를 확인하는 짧은 대화
- 악당과의 대치에서 명대사`,
    pacingNote: '행동 → 짧은 휴식 → 더 큰 행동의 에스컬레이션. 멈추지 않는 추진력.',
    thematicFocus: '용기, 희생, 팀워크, 정의 실현, 한계 극복',
    dilemmaTypes: [
      '정면 돌파할 것인가 우회할 것인가',
      '한 명을 구할 것인가 다수를 구할 것인가',
      '후퇴할 것인가 끝까지 싸울 것인가',
      '규칙을 따를 것인가 스스로 판단할 것인가',
    ],
    emotionalRange: '흥분, 용기, 분노, 승리감, 동료애, 결의',
    writingTechniques: `
- 동작의 시각적 묘사
- 시간을 늦추는 슬로모션 효과
- 전투 중 캐릭터 성장
- 팀워크 시너지 연출`,
    atmosphereKeywords: ['폭발', '질주', '충돌', '비명', '먼지', '섬광'],
    choiceFraming: '전술적 결정. 리스크와 보상이 명확한 선택.',
  },

  모험: {
    narrativeTone: `
서사 톤: 경이로움과 발견의 연속
- 미지의 세계에 대한 호기심
- 도전과 성장의 여정
- 낭만적이면서도 위험한 탐험
- 동료와 함께하는 성장담`,
    dialogueStyle: `
대사 스타일: 희망차고 활기찬 대화
- 새로운 발견에 대한 감탄
- 동료 간 농담과 격려
- 어려움 속에서도 유머 유지
- 목표에 대한 열정적 선언`,
    pacingNote: '탐험 → 위기 → 극복 → 보상의 사이클. 성취감을 주는 리듬.',
    thematicFocus: '꿈의 추구, 우정, 성장, 용기, 미지의 세계',
    dilemmaTypes: [
      '안전한 길을 택할 것인가 위험하지만 빠른 길을 택할 것인가',
      '보물을 취할 것인가 동료를 구할 것인가',
      '돌아갈 것인가 더 깊이 들어갈 것인가',
      '현지인을 도울 것인가 목표에 집중할 것인가',
    ],
    emotionalRange: '호기심, 경이, 두려움, 용기, 성취감, 우정',
    writingTechniques: `
- 새로운 환경의 생생한 묘사
- 각 동료의 역할과 기여
- 실패에서 배우는 성장
- 예상치 못한 발견의 기쁨`,
    atmosphereKeywords: ['지평선', '미지', '보물', '지도', '동굴', '별빛'],
    choiceFraming: '탐험 방향과 우선순위 결정. 모험의 본질적 가치 추구.',
  },

  전쟁: {
    narrativeTone: `
서사 톤: 비극적이고 웅장한 스케일
- 개인의 이야기와 역사의 교차
- 희생과 명예의 무게
- 전쟁의 참혹함과 인간애 공존
- 영웅적 순간과 비극적 손실`,
    dialogueStyle: `
대사 스타일: 무게감 있고 결연한 대사
- 전우애를 확인하는 진솔한 대화
- 지휘관의 결단력 있는 명령
- 죽음을 앞둔 유언 같은 말들
- 적과의 대치에서 신념 대결`,
    pacingNote: '전투와 소강 상태의 교차. 긴장의 축적과 폭발.',
    thematicFocus: '희생, 명예, 전우애, 리더십, 전쟁의 비극성',
    dilemmaTypes: [
      '명령에 따를 것인가 양심에 따를 것인가',
      '소수를 희생해 다수를 살릴 것인가',
      '전진할 것인가 후퇴하여 재정비할 것인가',
      '적을 죽일 것인가 포로로 잡을 것인가',
    ],
    emotionalRange: '두려움, 용기, 슬픔, 분노, 전우애, 죄책감, 명예심',
    writingTechniques: `
- 전투 장면의 혼란과 잔혹함
- 고요한 순간의 인간적 교류
- 편지나 회상을 통한 감정 심화
- 희생의 의미 부여`,
    atmosphereKeywords: ['총성', '연기', '참호', '피', '훈장', '무덤'],
    choiceFraming: '생사가 걸린 전술적 결정. 모든 선택에 희생이 따름.',
  },

  // ============================================
  // SF/판타지 장르
  // ============================================
  SF: {
    narrativeTone: `
서사 톤: 미래지향적이고 사색적인 분위기
- 기술과 인간성의 관계 탐구
- 새로운 세계관의 논리적 전개
- 철학적 질문과 과학적 상상력
- 디스토피아적 또는 유토피아적 비전`,
    dialogueStyle: `
대사 스타일: 지적이고 개념적인 대화
- 기술 용어의 자연스러운 사용
- AI나 외계인과의 소통
- 인간 정체성에 대한 성찰
- 미래 사회의 가치관 충돌`,
    pacingNote: '세계관 설명과 액션의 균형. 아이디어의 점진적 확장.',
    thematicFocus: '기술의 윤리, 인간성의 정의, 진보의 대가, 존재의 의미',
    dilemmaTypes: [
      '기술 발전을 추구할 것인가 제한할 것인가',
      'AI를 신뢰할 것인가 의심할 것인가',
      '개인의 자유를 지킬 것인가 집단의 안전을 택할 것인가',
      '과거로 돌아갈 것인가 미래를 받아들일 것인가',
    ],
    emotionalRange: '경이, 불안, 고독, 희망, 소외감, 호기심',
    writingTechniques: `
- 미래 기술의 구체적 묘사
- 인간과 기계의 대비
- 윤리적 딜레마의 심화
- 과학적 개념의 서사적 활용`,
    atmosphereKeywords: ['홀로그램', '네온', '우주', '데이터', '사이버', '안드로이드'],
    choiceFraming: '기술과 인간성 사이의 균형. 진보의 방향 결정.',
  },

  판타지: {
    narrativeTone: `
서사 톤: 신비롭고 웅장한 서사시
- 선과 악의 대립
- 운명과 예언의 무게
- 마법 세계의 경이로움
- 영웅의 여정과 성장`,
    dialogueStyle: `
대사 스타일: 고풍스럽고 장엄한 어조
- 예언이나 주문 같은 시적 표현
- 지혜로운 조언자의 수수께끼
- 악당의 위협적이고 거만한 말투
- 영웅의 결의 표명`,
    pacingNote: '긴 여정과 결정적 전투의 교차. 신화적 구조의 리듬.',
    thematicFocus: '선과 악, 운명과 선택, 희생과 구원, 성장',
    dilemmaTypes: [
      '힘을 사용할 것인가 자제할 것인가',
      '예언을 따를 것인가 자신의 길을 갈 것인가',
      '동맹을 믿을 것인가 혼자 감당할 것인가',
      '어둠의 유혹을 이길 것인가 굴복할 것인가',
    ],
    emotionalRange: '경외, 두려움, 용기, 사랑, 희망, 절망, 경이',
    writingTechniques: `
- 마법 시스템의 일관된 규칙
- 신화적 이미지와 상징
- 영웅의 내적 성장
- 서사시적 전투 묘사`,
    atmosphereKeywords: ['마법', '용', '왕국', '검', '예언', '고대'],
    choiceFraming: '운명과 의지 사이의 선택. 힘의 사용과 그 대가.',
  },

  '포스트 아포칼립스': {
    narrativeTone: `
서사 톤: 황량하고 절박한 생존기
- 문명 붕괴 후의 잔혹한 현실
- 인간 본성의 극단적 시험
- 작은 희망의 소중함
- 새로운 사회 질서의 형성`,
    dialogueStyle: `
대사 스타일: 거칠고 실용적인 대화
- 자원과 생존에 대한 직접적 언급
- 과거 세계에 대한 향수
- 신뢰 구축의 어려움 반영
- 새로운 규칙과 도덕에 대한 논쟁`,
    pacingNote: '일상적 생존과 급박한 위기의 반복. 희망과 절망의 교차.',
    thematicFocus: '생존, 인간성 유지, 공동체, 희망, 재건',
    dilemmaTypes: [
      '나눌 것인가 독점할 것인가',
      '새 생존자를 받아들일 것인가 거부할 것인가',
      '안전한 곳에 머물 것인가 더 나은 곳을 찾아 떠날 것인가',
      '복수할 것인가 평화를 택할 것인가',
    ],
    emotionalRange: '절망, 희망, 두려움, 분노, 연대, 외로움',
    writingTechniques: `
- 폐허가 된 세계의 묘사
- 과거와 현재의 대비
- 자원 부족의 긴박감
- 작은 인간적 순간의 감동`,
    atmosphereKeywords: ['폐허', '먼지', '생존', '배급', '약탈', '방벽'],
    choiceFraming: '자원과 인간성 사이의 균형. 생존과 도덕의 충돌.',
  },

  // ============================================
  // 감성/드라마 장르
  // ============================================
  드라마: {
    narrativeTone: `
서사 톤: 감정적 깊이와 인간관계 중심
- 일상 속 갈등과 화해
- 캐릭터의 심리적 변화
- 관계의 복잡성 탐구
- 현실적이고 공감 가능한 상황`,
    dialogueStyle: `
대사 스타일: 자연스럽고 감정이 풍부한 대화
- 말하지 못한 감정의 표현
- 오해와 화해의 과정
- 진심 어린 고백과 사과
- 일상적이지만 의미 있는 대화`,
    pacingNote: '감정의 빌드업과 해소. 조용한 순간의 무게.',
    thematicFocus: '가족, 사랑, 우정, 성장, 용서, 상실',
    dilemmaTypes: [
      '진실을 말할 것인가 관계를 지킬 것인가',
      '꿈을 따를 것인가 현실에 타협할 것인가',
      '용서할 것인가 단절할 것인가',
      '변화할 것인가 현재를 유지할 것인가',
    ],
    emotionalRange: '사랑, 슬픔, 기쁨, 분노, 그리움, 희망, 후회',
    writingTechniques: `
- 내면 독백을 통한 심리 묘사
- 소소한 디테일의 의미 부여
- 플래시백으로 관계 심화
- 대화 속 침묵의 활용`,
    atmosphereKeywords: ['눈물', '미소', '포옹', '편지', '기억', '약속'],
    choiceFraming: '관계와 가치관의 선택. 감정적 결과가 중요한 결정.',
  },

  로맨스: {
    narrativeTone: `
서사 톤: 설렘과 감동이 교차하는 사랑 이야기
- 두 사람의 감정 변화 섬세하게
- 장애물과 오해, 그리고 극복
- 달달한 순간과 가슴 아픈 순간
- 운명적 만남의 감성`,
    dialogueStyle: `
대사 스타일: 달콤하고 진심 어린 대화
- 고백과 속마음 토로
- 티격태격하는 귀여운 말다툼
- 눈빛과 행동으로 전하는 마음
- 감동적인 프로포즈나 약속`,
    pacingNote: '밀당의 리듬. 가까워졌다 멀어지는 감정의 파도.',
    thematicFocus: '사랑, 운명, 성장, 헌신, 소울메이트',
    dilemmaTypes: [
      '고백할 것인가 기다릴 것인가',
      '사랑을 선택할 것인가 현실을 선택할 것인가',
      '과거를 극복할 것인가 새 시작을 포기할 것인가',
      '함께할 것인가 상대를 위해 떠날 것인가',
    ],
    emotionalRange: '설렘, 행복, 질투, 그리움, 불안, 감동',
    writingTechniques: `
- 시선과 작은 행동의 의미
- 우연한 만남과 운명적 순간
- 감정의 점진적 발전
- 클라이맥스의 감동적 고백`,
    atmosphereKeywords: ['벚꽃', '노을', '카페', '비', '편지', '선물'],
    choiceFraming: '사랑과 관련된 용기 있는 선택. 마음을 따를 것인가.',
  },

  멜로: {
    narrativeTone: `
서사 톤: 아름답지만 슬픈 사랑의 서사
- 이룰 수 없는 사랑의 아픔
- 이별과 재회, 그리움
- 눈물 없이 볼 수 없는 감동
- 비극적 아름다움`,
    dialogueStyle: `
대사 스타일: 시적이고 감상적인 대화
- 차마 하지 못하는 말들
- 이별을 앞둔 마지막 대화
- 편지나 유언 형식의 독백
- 그리움이 묻어나는 회상`,
    pacingNote: '느리게 조여오는 슬픔. 감정의 깊은 여운.',
    thematicFocus: '이별, 상실, 그리움, 희생적 사랑, 운명',
    dilemmaTypes: [
      '떠날 것인가 남을 것인가',
      '기억할 것인가 잊을 것인가',
      '진실을 알릴 것인가 혼자 감당할 것인가',
      '행복을 포기할 것인가 상대를 놓아줄 것인가',
    ],
    emotionalRange: '슬픔, 그리움, 체념, 후회, 애틋함, 눈물',
    writingTechniques: `
- 시간의 흐름과 계절의 변화
- 추억의 장소와 물건
- 운명의 잔인함 암시
- 여운 남기는 결말`,
    atmosphereKeywords: ['비', '낙엽', '눈', '빈자리', '사진', '추억'],
    choiceFraming: '사랑과 이별 사이의 고통스러운 선택. 희생의 의미.',
  },

  // ============================================
  // 시대/역사 장르
  // ============================================
  사극: {
    narrativeTone: `
서사 톤: 역사적 무게와 품격 있는 서사
- 궁중의 권력 다툼과 음모
- 충과 효, 의리의 가치
- 시대적 배경의 생생한 재현
- 대하드라마적 스케일`,
    dialogueStyle: `
대사 스타일: 고어체와 존칭을 사용한 격식 있는 대화
- "하옵니다", "~하오" 등 사극체
- 왕과 신하의 위계 반영
- 비유와 고사성어 활용
- 품위 있으면서 날카로운 대립`,
    pacingNote: '느리지만 무게감 있는 전개. 정치적 반전의 충격.',
    thematicFocus: '충성, 명분, 권력, 가문, 사랑과 의무',
    dilemmaTypes: [
      '왕명에 따를 것인가 의를 지킬 것인가',
      '가문을 지킬 것인가 정의를 택할 것인가',
      '출세를 위해 타협할 것인가 소신을 지킬 것인가',
      '사랑을 따를 것인가 혼인 동맹을 따를 것인가',
    ],
    emotionalRange: '충성, 분노, 복수심, 슬픔, 자부심, 굴욕',
    writingTechniques: `
- 궁중 예법과 의전 묘사
- 정치적 암투와 책략
- 역사적 사건과의 연결
- 의복, 건축 등 시대 고증`,
    atmosphereKeywords: ['대전', '어좌', '비단', '옥새', '창덕궁', '사약'],
    choiceFraming: '명분과 실리, 충성과 생존 사이의 선택.',
  },

  역사: {
    narrativeTone: `
서사 톤: 시대를 관통하는 인간 이야기
- 실제 역사적 사건의 재해석
- 시대 속 개인의 삶
- 역사의 교훈과 현재의 연결
- 다큐멘터리적 사실감`,
    dialogueStyle: `
대사 스타일: 시대에 맞는 자연스러운 대화
- 시대 배경에 맞는 어휘 선택
- 당시 사회상 반영
- 역사적 인물의 카리스마
- 서민과 귀족의 말투 구분`,
    pacingNote: '역사적 사건의 흐름에 따른 전개. 개인과 시대의 교차.',
    thematicFocus: '시대정신, 변화, 저항, 희생, 역사의 의미',
    dilemmaTypes: [
      '시대에 순응할 것인가 저항할 것인가',
      '대의를 위해 희생할 것인가 가족을 지킬 것인가',
      '역사에 기록될 것인가 숨어서 살 것인가',
      '새 시대를 열 것인가 전통을 지킬 것인가',
    ],
    emotionalRange: '시대적 고뇌, 저항 정신, 희생, 희망, 절망',
    writingTechniques: `
- 역사적 정확성 유지
- 시대 분위기 재현
- 실존 인물과 가상 인물의 조화
- 역사적 의미의 현대적 해석`,
    atmosphereKeywords: ['시대', '민중', '봉기', '개혁', '전쟁', '조약'],
    choiceFraming: '역사의 흐름 속에서 개인의 선택. 시대와의 관계.',
  },

  // ============================================
  // 코미디/가벼운 장르
  // ============================================
  코미디: {
    narrativeTone: `
서사 톤: 유쾌하고 웃음 가득한 이야기
- 상황 코미디와 캐릭터 코미디
- 긴장을 웃음으로 해소
- 과장과 반전의 유머
- 해피엔딩 지향`,
    dialogueStyle: `
대사 스타일: 위트 있고 유머러스한 대화
- 타이밍 좋은 개그
- 캐릭터별 특유의 유머 스타일
- 언어유희와 말장난
- 바보 같지만 사랑스러운 대사`,
    pacingNote: '개그 → 개그 → 잠시 진지 → 더 큰 개그. 웃음의 리듬.',
    thematicFocus: '우정, 사랑, 일상의 소소함, 성장, 화해',
    dilemmaTypes: [
      '창피를 무릅쓸 것인가 포기할 것인가',
      '거짓말이 들킬 것인가 더 큰 거짓말을 할 것인가',
      '체면을 지킬 것인가 진심을 보일 것인가',
      '편한 길을 갈 것인가 어렵지만 올바른 길을 갈 것인가',
    ],
    emotionalRange: '즐거움, 당황, 기쁨, 감동, 부끄러움, 뿌듯함',
    writingTechniques: `
- 예상 밖의 반전
- 과장된 리액션
- 반복되는 개그 패턴
- 따뜻한 결말로 마무리`,
    atmosphereKeywords: ['웃음', '소란', '실수', '오해', '화해', '파티'],
    choiceFraming: '진지한 척 하지만 웃긴 상황. 가벼운 결과의 선택.',
  },

  가족: {
    narrativeTone: `
서사 톤: 따뜻하고 가슴 뭉클한 이야기
- 가족 간의 갈등과 화해
- 세대 간 이해와 소통
- 일상의 소중함
- 무조건적 사랑의 의미`,
    dialogueStyle: `
대사 스타일: 진솔하고 정감 있는 대화
- 잔소리지만 사랑 담긴 말
- 세대 차이 드러나는 대화
- 차마 못하던 고백
- 밥상머리 대화의 따뜻함`,
    pacingNote: '일상의 리듬. 갈등 후 화해, 눈물 후 웃음.',
    thematicFocus: '가족애, 세대 이해, 용서, 추억, 성장',
    dilemmaTypes: [
      '내 꿈을 따를 것인가 가족의 기대에 부응할 것인가',
      '진실을 말할 것인가 가족을 보호할 것인가',
      '독립할 것인가 함께 할 것인가',
      '용서할 것인가 거리를 둘 것인가',
    ],
    emotionalRange: '사랑, 그리움, 감사, 미안함, 뿌듯함, 눈물',
    writingTechniques: `
- 세대별 시각 차이 묘사
- 추억과 현재의 교차
- 식사 장면의 활용
- 작은 행동에 담긴 사랑`,
    atmosphereKeywords: ['집', '밥상', '명절', '사진첩', '편지', '돌잔치'],
    choiceFraming: '가족과 개인 사이의 균형. 관계를 위한 선택.',
  },

  // ============================================
  // 기본값
  // ============================================
  default: {
    narrativeTone: `
서사 톤: 몰입감 있는 이야기 전개
- 캐릭터 중심의 서사
- 감정적 깊이와 갈등
- 자연스러운 전개
- 의미 있는 선택`,
    dialogueStyle: `
대사 스타일: 자연스럽고 캐릭터에 맞는 대화
- 각 캐릭터의 개성 반영
- 상황에 맞는 어조
- 감정이 드러나는 대화
- 서사를 추동하는 대사`,
    pacingNote: '상황에 맞는 적절한 전개. 긴장과 이완의 균형.',
    thematicFocus: '인간 관계, 성장, 선택의 결과, 가치관',
    dilemmaTypes: [
      '이익을 택할 것인가 원칙을 지킬 것인가',
      '안전을 택할 것인가 도전할 것인가',
      '혼자 해결할 것인가 도움을 구할 것인가',
      '현재에 충실할 것인가 미래를 준비할 것인가',
    ],
    emotionalRange: '다양한 감정의 자연스러운 흐름',
    writingTechniques: `
- 캐릭터의 일관된 묘사
- 복선과 결과의 연결
- 감정 이입 가능한 상황
- 의미 있는 결말`,
    atmosphereKeywords: ['변화', '선택', '관계', '성장', '갈등', '화해'],
    choiceFraming: '캐릭터와 상황에 맞는 의미 있는 선택.',
  },
};

/**
 * 장르 배열에서 가장 적합한 서사 스타일을 가져옵니다.
 */
export function getNarrativeStyleFromGenres(
  genres: string[],
): GenreNarrativeStyle {
  if (!genres || genres.length === 0) {
    return GENRE_NARRATIVE_STYLES['default'];
  }

  // 첫 번째 매칭되는 장르의 스타일 반환
  for (const genre of genres) {
    const normalizedGenre = genre.trim();
    if (GENRE_NARRATIVE_STYLES[normalizedGenre]) {
      return GENRE_NARRATIVE_STYLES[normalizedGenre];
    }
  }

  return GENRE_NARRATIVE_STYLES['default'];
}

/**
 * 장르 스타일을 프롬프트용 텍스트로 포맷팅합니다.
 */
export function formatGenreStyleForPrompt(
  genres: string[],
  options: {
    includeDialogue?: boolean;
    includePacing?: boolean;
    includeDilemmas?: boolean;
    includeWritingTechniques?: boolean;
  } = {},
): string {
  const {
    includeDialogue = true,
    includePacing = true,
    includeDilemmas = true,
    includeWritingTechniques = true,
  } = options;

  const style = getNarrativeStyleFromGenres(genres);
  const genreText = genres.length > 0 ? genres.join(', ') : '일반';

  let prompt = `
### 장르별 서사 가이드 (${genreText}) ###

${style.narrativeTone}
`;

  if (includeDialogue) {
    prompt += `
${style.dialogueStyle}
`;
  }

  if (includePacing) {
    prompt += `
페이싱: ${style.pacingNote}

주요 테마: ${style.thematicFocus}
감정 범위: ${style.emotionalRange}
`;
  }

  if (includeDilemmas) {
    prompt += `
딜레마 유형 예시:
${style.dilemmaTypes.map((d, i) => `${i + 1}. ${d}`).join('\n')}
`;
  }

  if (includeWritingTechniques) {
    prompt += `
${style.writingTechniques}

분위기 키워드: ${style.atmosphereKeywords.join(', ')}
선택지 프레이밍: ${style.choiceFraming}
`;
  }

  return prompt;
}

// 압축된 장르 스타일 함수는 현재 사용되지 않아 제거됨
